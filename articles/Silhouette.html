<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Silhouette Package • Silhouette</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Silhouette Package">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Silhouette</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.9.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/Silhouette.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Silhouette Package</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/kskbhat/Silhouette/blob/main/vignettes/Silhouette.Rmd" class="external-link"><code>vignettes/Silhouette.Rmd</code></a></small>
      <div class="d-none name"><code>Silhouette.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The Silhouette package provides a comprehensive and extensible
framework for computing and visualizing silhouette widths to assess
clustering quality in both crisp (hard) and soft (fuzzy/probabilistic)
clustering settings. Silhouette width, originally introduced by <span class="citation">Rousseeuw (1987)</span>, quantifies how similar an
observation is to its assigned cluster relative to the closest
alternative cluster. Scores range from -1 (indicative of poor
clustering) to 1 (excellent separation).</p>
<p><em>Note:</em> This package does not use the classical <span class="citation">Rousseeuw (1987)</span> calculation directly. Instead,
it generalizes and extends silhouette methodology as follows:</p>
<ul>
<li>Implements the Simplified Silhouette method <span class="citation">(Van der Laan, Pollard, and Bryan 2003)</span>, with
options for medoid or pac (Probability of Alternative Cluster, <span class="citation">Raymaekers and Rousseeuw (2022)</span>)
approaches.</li>
<li>Provides soft clustering silhouettes based on membership
probabilities <span class="citation">(Campello and Hruschka 2006; Bhat
Kapu and Kiruthika 2024)</span>, including density-based diagnostics
like certainty and density-based silhouettes.</li>
<li>Includes density-based silhouette (dbSilhouette) computation, which
leverages log-ratios of posterior probabilities for soft clustering
evaluation <span class="citation">(Menardi 2011)</span>.</li>
<li>Supports calculation of crisp, fuzzy, and median silhouette widths,
allowing flexible averaging methods to suit different clustering
needs.</li>
<li>Supports multi-way clustering evaluation via extSilhouette() <span class="citation">(Schepers, Ceulemans, and Van Mechelen 2008)</span>,
enabling silhouette analysis for biclustering or higher-order tensor
clustering. Offers customizable and informative visualization with
plotSilhouette(), including grayscale options and detailed cluster
legends. The package also integrates with clustering results from
popular R packages such as cluster (silhouette, pam, clara, fanny) and
factoextra (eclust, hcut).</li>
<li>Includes utility functions for creating and validating Silhouette
objects directly from components.</li>
</ul>
<p>This vignette demonstrates the essential features of the package
using the well-known iris dataset. It showcases both standard (crisp)
and fuzzy silhouette calculations, advanced plotting capabilities, and
extended silhouette metrics for multi-way clustering scenarios.</p>
<div class="section level3">
<h3 id="available-functions">Available Functions<a class="anchor" aria-label="anchor" href="#available-functions"></a>
</h3>
<p><strong><code><a href="../reference/Silhouette.html">Silhouette()</a></code></strong>: Calculates silhouette
widths for both crisp and fuzzy clustering, using user-supplied
proximity matrices.</p>
<p><strong><code><a href="../reference/softSilhouette.html">softSilhouette()</a></code></strong>: Computes silhouette
widths tailored to soft clustering by interpreting membership
probabilities as proximities.</p>
<p><strong><code><a href="../reference/dbSilhouette.html">dbSilhouette()</a></code></strong>: Computes density-based
silhouette widths for soft clustering, based on log-ratios of posterior
probabilities.</p>
<p><strong><code><a href="../reference/cerSilhouette.html">cerSilhouette()</a></code></strong>: Computes certainty
silhouette widths for soft clustering, using the maximum posterior
probabilities as silhouette values.</p>
<ul>
<li>
<strong><code><a href="../reference/calSilhouette.html">calSilhouette()</a></code></strong><br>
Computes all available silhouette indices from the package functions and
returns a comparative summary data frame. Automatically calculates
crisp, fuzzy, and median silhouette values across different methods
including proximity-based (medoid, pac), soft silhouette variations
(pp_pac, pp_medoid, nlpp_pac, nlpp_medoid, pd_pac, pd_medoid), and
probability-based methods (cer, db). Supports direct matrix input or
clustering function output for streamlined comparative analysis.</li>
</ul>
<p><strong><code><a href="../reference/getSilhouette.html">getSilhouette()</a></code></strong>: Constructs a
Silhouette class object directly from user-provided components (e.g.,
cluster assignments, neighbor clusters, silhouette widths).</p>
<p><strong><code><a href="../reference/is.Silhouette.html">is.Silhouette()</a></code></strong>: Tests whether an
object is of class “Silhouette”, with optional strict structural
validation.</p>
<p><strong><code>plot() / plotSilhouette()</code></strong>: Visualizes
silhouette widths as sorted bar plots, offering grayscale and flexible
legend options for clarity.</p>
<p><strong><code><a href="https://rdrr.io/pkg/blockcluster/man/summary-methods.html" class="external-link">summary()</a></code></strong>: Produces concise summaries
of average silhouette widths and cluster sizes for objects of class
Silhouette.</p>
<p><strong><code><a href="../reference/extSilhouette.html">extSilhouette()</a></code></strong>: Derives extended
silhouette widths for multi-way clustering problems, such as
biclustering or tensor clustering.</p>
</div>
</div>
<div class="section level2">
<h2 id="use-cases">Use Cases<a class="anchor" aria-label="anchor" href="#use-cases"></a>
</h2>
<div class="section level3">
<h3 id="simplified-silhouette-calculation">1. Simplified Silhouette Calculation<a class="anchor" aria-label="anchor" href="#simplified-silhouette-calculation"></a>
</h3>
<div class="section level4">
<h4 id="a--when-the-proximity-matrix-is-unknown-but-centers-of-clusters-are-known">a. When the Proximity Matrix is Unknown but Centers of Clusters Are
Known<a class="anchor" aria-label="anchor" href="#a--when-the-proximity-matrix-is-unknown-but-centers-of-clusters-are-known"></a>
</h4>
<p>This example demonstrates how to compute silhouette widths for a
clustering result when you have the proximity (distance) matrix between
observations and cluster centres unknown. The workflow uses the classic
<code>iris</code> dataset and k-means clustering.</p>
<p><strong>Steps:</strong></p>
<ul>
<li>
<strong>Clustering</strong>: Perform k-means clustering on
<code>iris[, -5]</code> with 3 clusters.</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">km</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span>, centers <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><em>Note</em>: The <code>kmeans</code> output (<code>km</code>) does
not include a proximity matrix. Therefore, distances between
observations and cluster centroids must be computed separately.</p>
<ul>
<li>
<strong>Compute the Proximity Matrix</strong>:<br>
Create a matrix of distances between each observation and cluster
centroid using <code>proxy::dist()</code>.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">proxy</span><span class="op">)</span></span>
<span><span class="va">dist_matrix</span> <span class="op">&lt;-</span> <span class="fu">proxy</span><span class="fu">::</span><span class="fu">dist</span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span>, <span class="va">km</span><span class="op">$</span><span class="va">centers</span><span class="op">)</span></span>
<span><span class="va">sil</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Silhouette.html">Silhouette</a></span><span class="op">(</span><span class="va">dist_matrix</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sil</span><span class="op">)</span></span>
<span><span class="co">#&gt;   cluster neighbor sil_width</span></span>
<span><span class="co">#&gt; 1       1        2 0.9586603</span></span>
<span><span class="co">#&gt; 2       1        2 0.8682865</span></span>
<span><span class="co">#&gt; 3       1        2 0.8831417</span></span>
<span><span class="co">#&gt; 4       1        2 0.8465006</span></span>
<span><span class="co">#&gt; 5       1        2 0.9455979</span></span>
<span><span class="co">#&gt; 6       1        2 0.7848442</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/blockcluster/man/summary-methods.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sil</span><span class="op">)</span></span>
<span><span class="co">#&gt; -----------------------------------------------------</span></span>
<span><span class="co">#&gt; Average crisp dissimilarity medoid silhouette: 0.6664</span></span>
<span><span class="co">#&gt; -----------------------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   cluster size avg.sil.width</span></span>
<span><span class="co">#&gt; 1       1   50        0.8592</span></span>
<span><span class="co">#&gt; 2       2   62        0.5546</span></span>
<span><span class="co">#&gt; 3       3   38        0.5950</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sil</span><span class="op">)</span></span></code></pre></div>
<p><img src="Silhouette_files/figure-html/crisp-silhouette1-1.png" alt="fig1.1" width="672"></p>
<ul>
<li>
<strong>Customize Calculation</strong>:<br>
To use the Probability of Alternative Cluster (PAC) method (which is
more penalised variation of medoid method) and return a sorted
output:</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sil_pac</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Silhouette.html">Silhouette</a></span><span class="op">(</span><span class="va">dist_matrix</span>, method <span class="op">=</span> <span class="st">"pac"</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sil_pac</span><span class="op">)</span></span>
<span><span class="co">#&gt;    cluster neighbor sil_width</span></span>
<span><span class="co">#&gt; 8        1        2 0.9611009</span></span>
<span><span class="co">#&gt; 40       1        2 0.9329754</span></span>
<span><span class="co">#&gt; 1        1        2 0.9206029</span></span>
<span><span class="co">#&gt; 18       1        2 0.9182947</span></span>
<span><span class="co">#&gt; 50       1        2 0.9158517</span></span>
<span><span class="co">#&gt; 41       1        2 0.8993130</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/blockcluster/man/summary-methods.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sil_pac</span><span class="op">)</span></span>
<span><span class="co">#&gt; --------------------------------------------------</span></span>
<span><span class="co">#&gt; Average crisp dissimilarity pac silhouette: 0.5376</span></span>
<span><span class="co">#&gt; --------------------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   cluster size avg.sil.width</span></span>
<span><span class="co">#&gt; 1       1   50        0.7603</span></span>
<span><span class="co">#&gt; 2       2   62        0.4136</span></span>
<span><span class="co">#&gt; 3       3   38        0.4468</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sil_pac</span><span class="op">)</span></span></code></pre></div>
<p><img src="Silhouette_files/figure-html/crisp-silhouette2-1.png" alt="fig1.2" width="672"></p>
<ul>
<li>
<strong>Accessing Silhouette Summaries</strong>:<br>
The <code>Silhouette</code> function prints overall and cluster-wise
silhouette indices to the R console if
<code>print.summary = TRUE</code>, but these values are not directly
stored in the returned object. To extract them programmatically, use the
<code><a href="https://rdrr.io/pkg/blockcluster/man/summary-methods.html" class="external-link">summary()</a></code> function:</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/blockcluster/man/summary-methods.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sil_pac</span>,print.summary <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; --------------------------------------------------</span></span>
<span><span class="co">#&gt; Average crisp dissimilarity pac silhouette: 0.5376</span></span>
<span><span class="co">#&gt; --------------------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   cluster size avg.sil.width</span></span>
<span><span class="co">#&gt; 1       1   50        0.7603</span></span>
<span><span class="co">#&gt; 2       2   62        0.4136</span></span>
<span><span class="co">#&gt; 3       3   38        0.4468</span></span>
<span><span class="co"># summary table</span></span>
<span><span class="va">s</span><span class="op">$</span><span class="va">sil.sum</span></span>
<span><span class="co">#&gt;   cluster size avg.sil.width</span></span>
<span><span class="co">#&gt; 1       1   50        0.7603</span></span>
<span><span class="co">#&gt; 2       2   62        0.4136</span></span>
<span><span class="co">#&gt; 3       3   38        0.4468</span></span>
<span><span class="co"># cluster wise silhouette widths</span></span>
<span><span class="va">s</span><span class="op">$</span><span class="va">clus.avg.widths</span></span>
<span><span class="co">#&gt;         1         2         3 </span></span>
<span><span class="co">#&gt; 0.7602929 0.4136203 0.4468368</span></span>
<span><span class="co"># Overall average silhouette width</span></span>
<span><span class="va">s</span><span class="op">$</span><span class="va">avg.width</span></span>
<span><span class="co">#&gt; [1] 0.5375927</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="b--when-the-proximity-matrix-is-known">b. When the Proximity Matrix Is Known<a class="anchor" aria-label="anchor" href="#b--when-the-proximity-matrix-is-known"></a>
</h4>
<p>This section describes how to compute silhouette widths when the
<strong>proximity matrix</strong>—representing distances between
observations and cluster centers—is readily available as part of the
clustering model output. The example makes use of fuzzy c-means
clustering via the <code>ppclust</code> package and the classic
<code>iris</code> dataset.</p>
<p><strong>Steps:</strong></p>
<ul>
<li>
<strong>Step 1: Perform Fuzzy C-Means Clustering</strong><br>
Apply fuzzy c-means clustering on <code>iris[, -5]</code> to create
three clusters.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ppclust</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">fm</span> <span class="op">&lt;-</span> <span class="fu">ppclust</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ppclust/man/fcm.html" class="external-link">fcm</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">iris</span><span class="op">[</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span>, centers <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<strong>Step 2: Compute Silhouette Widths Using the Proximity
Matrix</strong><br>
The output object <code>fm</code> contains a distance matrix
<code>fm$d</code> representing proximities between each observation and
each cluster center, which can be directly fed to the
<code><a href="../reference/Silhouette.html">Silhouette()</a></code> function.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sil_fm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Silhouette.html">Silhouette</a></span><span class="op">(</span><span class="va">fm</span><span class="op">$</span><span class="va">d</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sil_fm</span><span class="op">)</span></span></code></pre></div>
<p><img src="Silhouette_files/figure-html/crisp-silhouette4-1.png" alt="fig1.2" width="672"></p>
<ul>
<li>
<strong>Alternative: Directly Use the Clustering Function with
<code>clust_fun</code></strong><br>
To streamline the workflow, you can let the <code><a href="../reference/Silhouette.html">Silhouette()</a></code>
function internally handle both clustering and silhouette calculation by
supplying the name of the distance matrix (<code>"d"</code>) and the
desired clustering function:</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sil_fcm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Silhouette.html">Silhouette</a></span><span class="op">(</span>prox_matrix <span class="op">=</span> <span class="st">"d"</span>, clust_fun <span class="op">=</span> <span class="va">fcm</span>, x <span class="op">=</span> <span class="va">iris</span><span class="op">[</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span>, centers <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sil_fcm</span><span class="op">)</span></span></code></pre></div>
<p><img src="Silhouette_files/figure-html/crisp-silhouette5-1.png" alt="fig1.3" width="672"></p>
<p>This approach eliminates the explicit step of extracting the
proximity matrix, making analyses more concise.</p>
<p><strong>Summary:</strong><br>
When the proximity matrix is provided directly by a clustering algorithm
(as with fuzzy c-means), silhouette widths can be calculated in one
step. For further convenience, the <code><a href="../reference/Silhouette.html">Silhouette()</a></code> function
accepts both the proximity matrix and a clustering function, so that a
single command completes the clustering and computes silhouettes. This
greatly simplifies the process for methods with built-in proximity
outputs, supporting rapid and reproducible evaluation of clustering
separation and quality.</p>
</div>
<div class="section level4">
<h4 id="c--calculation-of-fuzzy-silhouette-index-for-soft-clustering-algorithms">c. Calculation of Fuzzy Silhouette Index for Soft Clustering
Algorithms<a class="anchor" aria-label="anchor" href="#c--calculation-of-fuzzy-silhouette-index-for-soft-clustering-algorithms"></a>
</h4>
<p>This section explains how to compute the fuzzy silhouette index when
both the <strong>proximity matrix</strong> (distances from observations
to cluster centers) and the <strong>membership probability
matrix</strong> are available. The process is demonstrated with fuzzy
c-means clustering from the <code>ppclust</code> package applied to the
classic <code>iris</code> dataset.</p>
<p><strong>Steps:</strong></p>
<ul>
<li>
<strong>Step 1: Perform Fuzzy C-Means Clustering</strong><br>
Apply fuzzy c-means clustering to the feature columns of the
<code>iris</code> dataset, specifying three clusters:</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">fm1</span> <span class="op">&lt;-</span> <span class="fu">ppclust</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ppclust/man/fcm.html" class="external-link">fcm</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">iris</span><span class="op">[</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span>, centers <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<strong>Step 2: Compute Fuzzy Silhouette Widths Using Proximity and
Membership Matrices</strong><br>
The clustering output <code>fm1</code> contains both the distance matrix
(<code>fm1$d</code>) and the membership probability matrix
(<code>fm1$u</code>) and <code>average = "fuzzy"</code>. These can be
directly passed to the <code><a href="../reference/Silhouette.html">Silhouette()</a></code> function to compute
fuzzy silhouette widths:</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sil_fm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Silhouette.html">Silhouette</a></span><span class="op">(</span>prox_matrix <span class="op">=</span> <span class="va">fm1</span><span class="op">$</span><span class="va">d</span>, prob_matrix <span class="op">=</span> <span class="va">fm1</span><span class="op">$</span><span class="va">u</span>, average <span class="op">=</span> <span class="st">"fuzzy"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sil_fm1</span><span class="op">)</span></span></code></pre></div>
<p><img src="Silhouette_files/figure-html/fuzzy-silhouette4-1.png" alt="fig1.6" width="672"></p>
<ul>
<li>
<strong>Alternative: Use Clustering Function Inline with
<code>clust_fun</code></strong><br>
For an even more streamlined workflow, the <code><a href="../reference/Silhouette.html">Silhouette()</a></code>
function can internally manage clustering and silhouette calculations by
accepting the names of the distance and probability components
(<code>"d"</code> and <code>"u"</code>) along with the clustering
function:</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ppclust</span><span class="op">)</span></span>
<span><span class="va">sil_fcm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Silhouette.html">Silhouette</a></span><span class="op">(</span>prox_matrix <span class="op">=</span> <span class="st">"d"</span>, prob_matrix <span class="op">=</span> <span class="st">"u"</span>, average <span class="op">=</span> <span class="st">"fuzzy"</span>, clust_fun <span class="op">=</span> <span class="va">fcm</span>, x <span class="op">=</span> <span class="va">iris</span><span class="op">[</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span>, centers <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sil_fcm1</span><span class="op">)</span></span></code></pre></div>
<p><img src="Silhouette_files/figure-html/fuzzy-silhouette5-1.png" alt="fig1.3" width="672"></p>
<p>This approach removes the need to manually extract matrices from the
clustering result, improving code efficiency and reproducibility.</p>
<p><strong>Summary:</strong><br>
When both the proximity and membership probability matrices are directly
available from a clustering algorithm (such as fuzzy c-means), fuzzy
silhouette widths can be calculated efficiently in a single step. The
<code><a href="../reference/Silhouette.html">Silhouette()</a></code> function further supports an integrated
workflow by running both the clustering and silhouette calculations
internally when provided with the relevant function and argument names.
This functionality facilitates a concise, reproducible pipeline for
validating the quality and separation of soft clustering results.</p>
</div>
</div>
<div class="section level3">
<h3 id="comparing-two-soft-clustering-algorithms-using-the-soft-silhouette-function">2. Comparing Two Soft Clustering Algorithms Using the Soft
Silhouette Function<a class="anchor" aria-label="anchor" href="#comparing-two-soft-clustering-algorithms-using-the-soft-silhouette-function"></a>
</h3>
<p>It is often desirable to assess and compare the clustering quality of
different soft clustering algorithms on the same dataset. The
<strong>soft silhouette index</strong> offers a principled, internal
measure for this purpose, as it naturally incorporates the probabilistic
nature of soft clusters and provides a single value summarizing both
cluster compactness and separation.</p>
<p><strong>Example: Evaluating Fuzzy C-Means vs. an Alternative Soft
Clustering Algorithm</strong></p>
<p>Suppose we wish to compare the performance of two fuzzy clustering
algorithms—such as Fuzzy C-Means (FCM) and a variant (e.g., FCM2)—using
the <code><a href="../reference/softSilhouette.html">softSilhouette()</a></code> function.</p>
<p><strong>Steps:</strong></p>
<ul>
<li>
<p><strong>Step 1: Perform Clustering with Both
Algorithms</strong></p>
<p>Fit each soft clustering algorithm on your dataset (e.g.,
<code>iris[, 1:4]</code>):</p>
</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># FCM clustering</span></span>
<span><span class="va">fcm_result</span> <span class="op">&lt;-</span> <span class="fu">ppclust</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ppclust/man/fcm.html" class="external-link">fcm</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># FCM2 clustering</span></span>
<span><span class="va">fcm2_result</span> <span class="op">&lt;-</span> <span class="fu">ppclust</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ppclust/man/fcm2.html" class="external-link">fcm2</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<p><strong>Step 2: Compute Soft Silhouette Index for Each
Result</strong></p>
<p>Use the membership probability matrices produced by each
algorithm:</p>
</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Soft silhouette for FCM</span></span>
<span><span class="va">sil_fcm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/softSilhouette.html">softSilhouette</a></span><span class="op">(</span>prob_matrix <span class="op">=</span> <span class="va">fcm_result</span><span class="op">$</span><span class="va">u</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sil_fcm</span><span class="op">)</span></span></code></pre></div>
<p><img src="Silhouette_files/figure-html/softSilhouette-1.png" alt="fig2.1" width="672"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Soft silhouette for FCM2</span></span>
<span><span class="va">sil_fcm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/softSilhouette.html">softSilhouette</a></span><span class="op">(</span>prob_matrix <span class="op">=</span> <span class="va">fcm2_result</span><span class="op">$</span><span class="va">u</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sil_fcm2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Silhouette_files/figure-html/softSilhouette-2.png" alt="fig2.1" width="672"></p>
<ul>
<li>
<p><strong>Step 3: Summarize and Compare Average Silhouette
Widths</strong></p>
<p>Extract the overall average silhouette width for each clustering
result:</p>
</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sfcm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/blockcluster/man/summary-methods.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sil_fcm</span>, print.summary <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">sfcm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/blockcluster/man/summary-methods.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sil_fcm2</span>, print.summary <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"FCM average silhouette width:"</span>, <span class="va">sfcm</span><span class="op">$</span><span class="va">avg.width</span>, <span class="st">"\n"</span>,</span>
<span>    <span class="st">"FCM2 average silhouette width:"</span>, <span class="va">sfcm2</span><span class="op">$</span><span class="va">avg.width</span><span class="op">)</span></span>
<span><span class="co">#&gt; FCM average silhouette width: 0.7541271 </span></span>
<span><span class="co">#&gt;  FCM2 average silhouette width: 0.411275</span></span></code></pre></div>
<p>A higher average silhouette width indicates a clustering with more
compact and well-separated clusters.</p>
<p><strong>Interpretation &amp; Guidance</strong></p>
<ul>
<li>
<strong>Interpret the Index</strong>: The algorithm yielding a
higher <em>average soft silhouette width</em> is considered to produce a
better clustering, as it balances cluster cohesion and separation while
accounting for the uncertainty inherent in soft assignments.</li>
<li>
<strong>Practical Application</strong>: This method is generic; any
two or more soft clustering results (not limited to FCM/FCM2) can be
compared effectively, provided you can extract the membership
probability matrix.</li>
<li>
<strong>Flexible Integration</strong>: The
<code><a href="../reference/softSilhouette.html">softSilhouette()</a></code> function also allows for different
silhouette calculation methods and transformations (such as
<code>prob_type = "nlpp"</code> for negative log-probabilities),
supporting deeper comparisons aligned with your methodological
framework.</li>
</ul>
<p><strong>Additional Soft Clustering Methods</strong></p>
<p>The package also provides two additional methods for computing soft
silhouette widths: <code><a href="../reference/cerSilhouette.html">cerSilhouette()</a></code> (Certainty-based) and
<code><a href="../reference/dbSilhouette.html">dbSilhouette()</a></code> (Density-based). These can be used in the
same way as <code><a href="../reference/softSilhouette.html">softSilhouette()</a></code> to compare clustering
algorithms.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Certainty-based silhouette for FCM and FCM2</span></span>
<span>  <span class="va">cer_fcm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cerSilhouette.html">cerSilhouette</a></span><span class="op">(</span>prob_matrix <span class="op">=</span> <span class="va">fcm_result</span><span class="op">$</span><span class="va">u</span>, print.summary <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; ----------------------------------------------</span></span>
<span><span class="co">#&gt; Average crisp similarity db silhouette: 0.8572</span></span>
<span><span class="co">#&gt; ----------------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   cluster size avg.sil.width</span></span>
<span><span class="co">#&gt; 1       1   60        0.7826</span></span>
<span><span class="co">#&gt; 2       2   40        0.8351</span></span>
<span><span class="co">#&gt; 3       3   50        0.9645</span></span>
<span><span class="co">#&gt; Available attributes: names, class, row.names, proximity_type, method, average</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cer_fcm</span><span class="op">)</span></span></code></pre></div>
<p><img src="Silhouette_files/figure-html/cer-db-silhouette-1.png" alt="fig2.3" width="672"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  </span>
<span>  <span class="va">cer_fcm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cerSilhouette.html">cerSilhouette</a></span><span class="op">(</span>prob_matrix <span class="op">=</span> <span class="va">fcm2_result</span><span class="op">$</span><span class="va">u</span>, print.summary <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; ----------------------------------------------</span></span>
<span><span class="co">#&gt; Average crisp similarity db silhouette: 0.6236</span></span>
<span><span class="co">#&gt; ----------------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   cluster size avg.sil.width</span></span>
<span><span class="co">#&gt; 1       1   25        0.5974</span></span>
<span><span class="co">#&gt; 2       2   65        0.7135</span></span>
<span><span class="co">#&gt; 3       3   60        0.5371</span></span>
<span><span class="co">#&gt; Available attributes: names, class, row.names, proximity_type, method, average</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cer_fcm2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Silhouette_files/figure-html/cer-db-silhouette-2.png" alt="fig2.3" width="672"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Density-based silhouette for FCM and FCM2</span></span>
<span>  <span class="va">db_fcm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dbSilhouette.html">dbSilhouette</a></span><span class="op">(</span>prob_matrix <span class="op">=</span> <span class="va">fcm_result</span><span class="op">$</span><span class="va">u</span>, print.summary <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; ---------------------------------------</span></span>
<span><span class="co">#&gt; Median similarity db silhouette: 0.3098</span></span>
<span><span class="co">#&gt; ---------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   cluster size avg.sil.width</span></span>
<span><span class="co">#&gt; 1       1   60        0.2225</span></span>
<span><span class="co">#&gt; 2       2   40        0.2456</span></span>
<span><span class="co">#&gt; 3       3   50        0.5074</span></span>
<span><span class="co">#&gt; Available attributes: names, class, row.names, proximity_type, method, average</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">db_fcm</span><span class="op">)</span></span></code></pre></div>
<p><img src="Silhouette_files/figure-html/cer-db-silhouette-3.png" alt="fig2.3" width="672"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  </span>
<span>  <span class="va">db_fcm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dbSilhouette.html">dbSilhouette</a></span><span class="op">(</span>prob_matrix <span class="op">=</span> <span class="va">fcm2_result</span><span class="op">$</span><span class="va">u</span>, print.summary <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; ---------------------------------------</span></span>
<span><span class="co">#&gt; Median similarity db silhouette: 0.2607</span></span>
<span><span class="co">#&gt; ---------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   cluster size avg.sil.width</span></span>
<span><span class="co">#&gt; 1       1   25        0.2642</span></span>
<span><span class="co">#&gt; 2       2   65        0.4942</span></span>
<span><span class="co">#&gt; 3       3   60        0.1943</span></span>
<span><span class="co">#&gt; Available attributes: names, class, row.names, proximity_type, method, average</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">db_fcm2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Silhouette_files/figure-html/cer-db-silhouette-4.png" alt="fig2.3" width="672"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare average silhouette widths across all methods</span></span>
<span>  <span class="co"># Summary for FCM</span></span>
<span>  <span class="va">cer_sfcm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/blockcluster/man/summary-methods.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cer_fcm</span>, print.summary <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">db_sfcm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/blockcluster/man/summary-methods.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">db_fcm</span>, print.summary <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Summary for FCM2</span></span>
<span>  <span class="va">cer_sfcm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/blockcluster/man/summary-methods.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cer_fcm2</span>, print.summary <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">db_sfcm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/blockcluster/man/summary-methods.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">db_fcm2</span>, print.summary <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Print comparison</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"FCM - Soft silhouette:"</span>, <span class="va">sfcm</span><span class="op">$</span><span class="va">avg.width</span>, <span class="st">"\n"</span>,</span>
<span>      <span class="st">"FCM - Certainty silhouette:"</span>, <span class="va">cer_sfcm</span><span class="op">$</span><span class="va">avg.width</span>, <span class="st">"\n"</span>,</span>
<span>      <span class="st">"FCM - Density-based silhouette:"</span>, <span class="va">db_sfcm</span><span class="op">$</span><span class="va">avg.width</span>, </span>
<span>      <span class="st">"\n\n"</span>,<span class="st">"FCM2 - Soft silhouette:"</span>, <span class="va">sfcm2</span><span class="op">$</span><span class="va">avg.width</span>, </span>
<span>      <span class="st">"\n"</span>,<span class="st">"FCM2 - Certainty silhouette:"</span>, <span class="va">cer_sfcm2</span><span class="op">$</span><span class="va">avg.width</span>, </span>
<span>      <span class="st">"\n"</span>,<span class="st">"FCM2 - Density-based silhouette:"</span>, <span class="va">db_sfcm2</span><span class="op">$</span><span class="va">avg.width</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; FCM - Soft silhouette: 0.7541271 </span></span>
<span><span class="co">#&gt;  FCM - Certainty silhouette: 0.8572481 </span></span>
<span><span class="co">#&gt;  FCM - Density-based silhouette: 0.3097745 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  FCM2 - Soft silhouette: 0.411275 </span></span>
<span><span class="co">#&gt;  FCM2 - Certainty silhouette: 0.6235972 </span></span>
<span><span class="co">#&gt;  FCM2 - Density-based silhouette: 0.2607283</span></span></code></pre></div>
<p><strong>Summary:</strong><br>
Comparing the average soft silhouette widths from different soft
clustering algorithms provides an objective, data-driven basis for
determining which method produces more meaningful, well-defined clusters
in probabilistic settings. This approach harmonizes easily with both
classic fuzzy clustering and more advanced algorithms, and can be
extended to other soft silhouette methods like certainty-based and
density-based approaches.</p>
</div>
<div class="section level3">
<h3 id="scree-plot-for-optimal-number-of-clusters">3. Scree Plot for Optimal Number of Clusters<a class="anchor" aria-label="anchor" href="#scree-plot-for-optimal-number-of-clusters"></a>
</h3>
<p>The scree plot (also called the “elbow plot” or “reverse elbow plot”)
is a practical tool for identifying the best number of clusters in
unsupervised learning. Here, the silhouette width is calculated for
different values of <em>k</em> (number of clusters). The resulting plot
provides a visual indication of the optimal cluster count by
highlighting where increasing <em>k</em> yields only marginal
improvements in the average silhouette width.</p>
<p><strong>Steps:</strong></p>
<ul>
<li>
<strong>Step 1: Compute Average Silhouette Widths at Varying Cluster
Counts</strong><br>
Run silhouette analysis across a range of possible cluster numbers
(e.g., 2 to 7). For each <em>k</em>, use the any <code>Silhouette</code>
class function to calculate the silhouette widths, then extract the
average silhouette width from the summary.</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">avg_sil_width</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">7</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sil_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Silhouette.html">Silhouette</a></span><span class="op">(</span></span>
<span>    prox_matrix <span class="op">=</span> <span class="st">"d"</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"pac"</span>,</span>
<span>    clust_fun <span class="op">=</span> <span class="fu">ppclust</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ppclust/man/fcm.html" class="external-link">fcm</a></span>,</span>
<span>    x <span class="op">=</span> <span class="va">iris</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>    centers <span class="op">=</span> <span class="va">k</span><span class="op">)</span></span>
<span>  <span class="va">avg_sil_width</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/blockcluster/man/summary-methods.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sil_out</span>, print.summary <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">avg.width</span></span>
<span><span class="op">}</span></span></code></pre></div>
<ul>
<li>
<strong>Step 2: Create and Interpret the Scree Plot</strong><br>
Plot the number of clusters against the computed average silhouette
widths:</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">avg_sil_width</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"o"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Overall Silhouette Width"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Number of Clusters"</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Silhouette Scree Plot"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Silhouette_files/figure-html/screeplot2-1.png" alt="fig3.1" width="672"></p>
<p>The optimal number of clusters is often suggested by the “elbow” or
“reverse elbow”—the point after which increases in <em>k</em> lead to
diminishing or excessive improvements in silhouette width. This visual
guide is valuable for assessing the clustering structure in your
data.</p>
<p><em>Note:</em> Any <code>Silhouette</code> class functions can be
used to generate scree plots for optimal cluster selection. For
theoretical background and additional diagnostic options for soft
clustering, see <span class="citation">Bhat Kapu and Kiruthika
(2024)</span>.</p>
<p><strong>Summary:</strong><br>
The scree plot provides an intuitive graphical summary to assist in
choosing the optimal number of clusters by plotting average silhouette
width versus the number of clusters considered. The integrated use of
<code><a href="../reference/Silhouette.html">Silhouette()</a></code>, <code><a href="../reference/softSilhouette.html">softSilhouette()</a></code>,
<code><a href="../reference/cerSilhouette.html">cerSilhouette()</a></code>, <code><a href="../reference/dbSilhouette.html">dbSilhouette()</a></code> use of
<code>clust_fun</code> and summary functions makes this analysis
straightforward and efficient for both crisp and fuzzy clustering
frameworks. This method encourages a reproducible, objective approach to
cluster selection in unsupervised analysis.</p>
</div>
<div class="section level3">
<h3 id="visualizing-silhouette-analysis-results-with-plotsilhouette">4. Visualizing Silhouette Analysis Results with
<code>plotSilhouette()</code><a class="anchor" aria-label="anchor" href="#visualizing-silhouette-analysis-results-with-plotsilhouette"></a>
</h3>
<p>Efficient visualization of silhouette widths is essential for
interpreting and diagnosing clustering quality. The
<code><a href="../reference/plotSilhouette.html">plotSilhouette()</a></code> function provides a flexible and
extensible tool for plotting silhouette results from various clustering
algorithms, supporting both hard (crisp) and soft (fuzzy)
partitions.</p>
<p><strong>Key Features:</strong> - Accepts outputs from a wide range of
clustering methods: <code>Silhouette</code>,
<code>softSilhouette</code>, <code>dbSilhouette</code>,
<code>cerSilhouette</code> as well as clustering objects from
<code>cluster</code> (<code>pam</code>, <code>clara</code>,
<code>fanny</code>, base <code>silhouette</code>) and
<code>factoextra</code> (<code>eclust</code>, <code>hcut</code>). -
Offers detailed legends summarizing average silhouette widths and
cluster sizes. - Supports customizable color palettes, including
grayscale, and the option to label observations on the x-axis.</p>
<p><strong>Illustrative Use Cases and Code</strong></p>
<ul>
<li><strong>Crisp Silhouette Visualization (e.g., k-means
clustering):</strong></li>
</ul>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span>  <span class="va">km_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="va">dist_mat</span> <span class="op">&lt;-</span> <span class="fu">proxy</span><span class="fu">::</span><span class="fu">dist</span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span>, <span class="va">km_out</span><span class="op">$</span><span class="va">centers</span><span class="op">)</span></span>
<span>  <span class="va">sil_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Silhouette.html">Silhouette</a></span><span class="op">(</span><span class="va">dist_mat</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sil_obj</span><span class="op">)</span>                   <span class="co"># S3 method auto-dispatch</span></span></code></pre></div>
<p><img src="Silhouette_files/figure-html/plot0-1.png" alt="fig4.0" width="576"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="../reference/plotSilhouette.html">plotSilhouette</a></span><span class="op">(</span><span class="va">sil_obj</span><span class="op">)</span>         <span class="co"># explicit call (identical output)</span></span></code></pre></div>
<p><img src="Silhouette_files/figure-html/plot0-2.png" alt="fig4.0" width="576"></p>
<ul>
<li><strong>Crisp Silhouette from Cluster Algorithms (PAM, CLARA,
FANNY):</strong></li>
</ul>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/cluster/" class="external-link">cluster</a></span><span class="op">)</span></span>
<span><span class="va">pam_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/cluster/man/pam.html" class="external-link">pam</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotSilhouette.html">plotSilhouette</a></span><span class="op">(</span><span class="va">pam_result</span><span class="op">)</span> <span class="co"># for cluster::pam object</span></span></code></pre></div>
<p><img src="Silhouette_files/figure-html/plot1-1.png" alt="fig4.1" width="576"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">clara_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/cluster/man/clara.html" class="external-link">clara</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotSilhouette.html">plotSilhouette</a></span><span class="op">(</span><span class="va">clara_result</span><span class="op">)</span></span></code></pre></div>
<p><img src="Silhouette_files/figure-html/plot1-2.png" alt="fig4.1" width="576"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">fanny_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/cluster/man/fanny.html" class="external-link">fanny</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotSilhouette.html">plotSilhouette</a></span><span class="op">(</span><span class="va">fanny_result</span><span class="op">)</span></span></code></pre></div>
<p><img src="Silhouette_files/figure-html/plot1-3.png" alt="fig4.1" width="576"></p>
<ul>
<li><strong>Base silhouette object:</strong></li>
</ul>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sil_base</span> <span class="op">&lt;-</span> <span class="fu">cluster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cluster/man/silhouette.html" class="external-link">silhouette</a></span><span class="op">(</span><span class="va">pam_result</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotSilhouette.html">plotSilhouette</a></span><span class="op">(</span><span class="va">sil_base</span><span class="op">)</span></span></code></pre></div>
<p><img src="Silhouette_files/figure-html/plot2-1.png" alt="fig4.2" width="576"></p>
<ul>
<li><strong>factoextra::hcut/eclust clusterings:</strong></li>
</ul>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/factoextra" class="external-link">factoextra</a></span><span class="op">)</span></span>
<span><span class="va">eclust_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/eclust.html" class="external-link">eclust</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="st">"kmeans"</span>, k <span class="op">=</span> <span class="fl">3</span>, graph <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotSilhouette.html">plotSilhouette</a></span><span class="op">(</span><span class="va">eclust_result</span><span class="op">)</span></span></code></pre></div>
<p><img src="Silhouette_files/figure-html/plot3-1.png" alt="fig4.3" width="576"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">hcut_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/hcut.html" class="external-link">hcut</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotSilhouette.html">plotSilhouette</a></span><span class="op">(</span><span class="va">hcut_result</span><span class="op">)</span></span></code></pre></div>
<p><img src="Silhouette_files/figure-html/plot3-2.png" alt="fig4.3" width="576"></p>
<ul>
<li><strong>drclust::silhouette Visualization:</strong></li>
</ul>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">drclust</span><span class="op">)</span></span>
<span><span class="co"># Loading the numeric in matrix </span></span>
<span><span class="va">iris_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/proxy/man/dist.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="op">-</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#applying a clustering algorithm</span></span>
<span><span class="va">drclust_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/drclust/man/dpcakm.html" class="external-link">dpcakm</a></span><span class="op">(</span><span class="va">iris_mat</span>, <span class="fl">20</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#silhouette based on the data and the output of the clustering algorithm</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">silhouette</span><span class="op">(</span><span class="va">iris_mat</span>, <span class="va">drclust_out</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: `aes_string()` was deprecated in ggplot2 3.0.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use tidy evaluation idioms with `aes()`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> See also `vignette("ggplot2-in-packages")` for more information.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">factoextra</span> package.</span></span>
<span><span class="co">#&gt;   Please report the issue at <span style="color: #0000BB; font-style: italic;">&lt;https://github.com/kassambara/factoextra/issues&gt;</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span>
<span><span class="co">#&gt;    cluster size ave.sil.width</span></span>
<span><span class="co">#&gt; 1        1   17          0.16</span></span>
<span><span class="co">#&gt; 2        2   16          0.35</span></span>
<span><span class="co">#&gt; 3        3   14          0.06</span></span>
<span><span class="co">#&gt; 4        4   10          0.15</span></span>
<span><span class="co">#&gt; 5        5    9         -0.09</span></span>
<span><span class="co">#&gt; 6        6    9          0.11</span></span>
<span><span class="co">#&gt; 7        7    8          0.28</span></span>
<span><span class="co">#&gt; 8        8    8         -0.02</span></span>
<span><span class="co">#&gt; 9        9    7          0.23</span></span>
<span><span class="co">#&gt; 10      10    7          0.12</span></span>
<span><span class="co">#&gt; 11      11    7          0.08</span></span>
<span><span class="co">#&gt; 12      12    6          0.41</span></span>
<span><span class="co">#&gt; 13      13    6         -0.05</span></span>
<span><span class="co">#&gt; 14      14    6          0.09</span></span>
<span><span class="co">#&gt; 15      15    5          0.31</span></span>
<span><span class="co">#&gt; 16      16    4          0.08</span></span>
<span><span class="co">#&gt; 17      17    4          0.45</span></span>
<span><span class="co">#&gt; 18      18    3          0.28</span></span>
<span><span class="co">#&gt; 19      19    3          0.31</span></span>
<span><span class="co">#&gt; 20      20    1          0.00</span></span>
<span><span class="fu"><a href="../reference/plotSilhouette.html">plotSilhouette</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">cl.silhouette</span><span class="op">)</span></span></code></pre></div>
<p><img src="Silhouette_files/figure-html/plot3.1-1.png" alt="fig4.3.1" width="672"></p>
<ul>
<li><strong>Fuzzy (Soft) Silhouette Visualization (e.g., fuzzy c-means
with ppclust):</strong></li>
</ul>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">fcm_out</span> <span class="op">&lt;-</span> <span class="fu">ppclust</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ppclust/man/fcm.html" class="external-link">fcm</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">sil_fuzzy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Silhouette.html">Silhouette</a></span><span class="op">(</span></span>
<span>  prox_matrix <span class="op">=</span> <span class="st">"d"</span>, prob_matrix <span class="op">=</span> <span class="st">"u"</span>, clust_fun <span class="op">=</span> <span class="va">fcm</span>,</span>
<span>  x <span class="op">=</span> <span class="va">iris</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, centers <span class="op">=</span> <span class="fl">3</span>, sort <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sil_fuzzy</span>, summary.legend <span class="op">=</span> <span class="cn">FALSE</span>, grayscale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Silhouette_files/figure-html/plot4-1.png" alt="fig4.4" width="576"></p>
<ul>
<li><strong>Customization: Grayscale, Detailed Legends, and Observation
Labels:</strong></li>
</ul>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotSilhouette.html">plotSilhouette</a></span><span class="op">(</span><span class="va">sil_fuzzy</span>, grayscale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># Use grayscale palette</span></span></code></pre></div>
<p><img src="Silhouette_files/figure-html/plot5-1.png" alt="fig4.5" width="576"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotSilhouette.html">plotSilhouette</a></span><span class="op">(</span><span class="va">sil_fuzzy</span>, summary.legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># Include size + avg silhouette in legend</span></span></code></pre></div>
<p><img src="Silhouette_files/figure-html/plot5-2.png" alt="fig4.5" width="576"></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotSilhouette.html">plotSilhouette</a></span><span class="op">(</span><span class="va">sil_fuzzy</span>, label <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># Label bars with row index</span></span></code></pre></div>
<p><img src="Silhouette_files/figure-html/plot5-3.png" alt="fig4.5" width="576"></p>
<p><strong>Practical Guidance:</strong> - For clustering output classes
not supported by the generic <code><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot()</a></code> function, always use
<code><a href="../reference/plotSilhouette.html">plotSilhouette()</a></code> explicitly to ensure correct and
informative visualization. - The function automatically sorts silhouette
widths within clusters, displays the average silhouette (dashed line),
and provides detailed cluster summaries in the legend.</p>
<p><strong>Summary:</strong><br><code><a href="../reference/plotSilhouette.html">plotSilhouette()</a></code> brings unified, publication-ready
visualization capabilities for assessing crisp and fuzzy clustering at a
glance. Its broad compatibility, detailed legends, grayscale and
labeling options empower users to gain deeper insights into clustering
structure, facilitating clear diagnosis and reporting in both
exploratory and formal statistical workflows.</p>
</div>
<div class="section level3">
<h3 id="creating-and-validating-user-defined-silhouette-objects">5. Creating and Validating User-Defined Silhouette Objects<a class="anchor" aria-label="anchor" href="#creating-and-validating-user-defined-silhouette-objects"></a>
</h3>
<p>The <code><a href="../reference/getSilhouette.html">getSilhouette()</a></code> function enables users to manually
construct a <code>Silhouette</code> object from precomputed cluster
assignments, neighbor clusters, silhouette widths, and optional weights.
This is particularly useful for custom or externally derived clustering
results.</p>
<p>The <code><a href="../reference/is.Silhouette.html">is.Silhouette()</a></code> function validates whether an object
is a valid <code>Silhouette</code> object, ensuring it meets the
necessary structural and attribute requirements for visualization and
analysis.</p>
<p>Example:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a custom Silhouette object</span></span>
<span><span class="va">cluster_assignments</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">neighbor_clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">silhouette_widths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.6</span>, <span class="fl">0.9</span>, <span class="fl">0.5</span>, <span class="fl">0.4</span><span class="op">)</span></span>
<span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.95</span>, <span class="fl">0.6</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sil_custom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getSilhouette.html">getSilhouette</a></span><span class="op">(</span></span>
<span>  cluster <span class="op">=</span> <span class="va">cluster_assignments</span>,</span>
<span>  neighbor <span class="op">=</span> <span class="va">neighbor_clusters</span>,</span>
<span>  sil_width <span class="op">=</span> <span class="va">silhouette_widths</span>,</span>
<span>  weight <span class="op">=</span> <span class="va">weights</span>,</span>
<span>  proximity_type <span class="op">=</span> <span class="st">"similarity"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"pac"</span>,</span>
<span>  average <span class="op">=</span> <span class="st">"fuzzy"</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Validate the object</span></span>
<span><span class="fu"><a href="../reference/is.Silhouette.html">is.Silhouette</a></span><span class="op">(</span><span class="va">sil_custom</span><span class="op">)</span>               <span class="co"># Basic class check: TRUE</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="../reference/is.Silhouette.html">is.Silhouette</a></span><span class="op">(</span><span class="va">sil_custom</span>, strict <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># Strict structural validation: TRUE</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="../reference/is.Silhouette.html">is.Silhouette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span>      <span class="co"># Non-Silhouette object: FALSE</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co"># Visualize the custom Silhouette object</span></span>
<span><span class="fu"><a href="../reference/plotSilhouette.html">plotSilhouette</a></span><span class="op">(</span><span class="va">sil_custom</span>, summary.legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Silhouette_files/figure-html/custom1-1.png" alt="fig5.1" width="672"></p>
<p>This approach allows users to integrate custom silhouette
computations into the <strong>Silhouette</strong> package’s
visualization framework, ensuring flexibility for specialized workflows
while maintaining compatibility with <code><a href="../reference/plotSilhouette.html">plotSilhouette()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="comprehensive-comparison-of-all-silhouette-methods-with-calsilhouette">6. Comprehensive Comparison of All Silhouette Methods with
<code>calSilhouette()</code><a class="anchor" aria-label="anchor" href="#comprehensive-comparison-of-all-silhouette-methods-with-calsilhouette"></a>
</h3>
<p>The <code><a href="../reference/calSilhouette.html">calSilhouette()</a></code> function provides a streamlined
approach to compute and compare all available silhouette methods from
the package in a single call. This function is particularly useful
for:</p>
<ul>
<li>Comparing multiple silhouette computation methods
simultaneously</li>
<li>Evaluating clustering quality across different averaging approaches
(crisp, fuzzy, median)</li>
<li>Rapid assessment of clustering performance using various silhouette
formulations</li>
</ul>
<p><strong>Key Features:</strong> - Automatically computes all
compatible silhouette methods based on available input matrices -
Returns a comprehensive summary data frame comparing crisp, fuzzy, and
median silhouette values - Supports both direct matrix input and
clustering function output - Computes up to 11 different silhouette
methods when both proximity and probability matrices are provided</p>
<p><strong>Available Methods:</strong></p>
<p>When <strong>proximity matrix</strong> is provided: -
<code>medoid</code> - Medoid-based silhouette - <code>pac</code> -
PAC-based silhouette</p>
<p>When <strong>probability matrix</strong> is provided: -
<code>pp_pac</code>, <code>pp_medoid</code> - Posterior probabilities
with PAC/Medoid methods - <code>nlpp_pac</code>,
<code>nlpp_medoid</code> - Negative log posterior probabilities with
PAC/Medoid methods - <code>pd_pac</code>, <code>pd_medoid</code> -
Probability distribution with PAC/Medoid methods - <code>cer</code> -
Certainty-based silhouette - <code>db</code> - Density-based
silhouette</p>
<div class="section level4">
<h4 id="a--comprehensive-method-comparison-using-clustering-function">a. Comprehensive Method Comparison Using Clustering Function<a class="anchor" aria-label="anchor" href="#a--comprehensive-method-comparison-using-clustering-function"></a>
</h4>
<p>This example demonstrates how to use <code><a href="../reference/calSilhouette.html">calSilhouette()</a></code>
with a clustering function to automatically compute all available
silhouette methods:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ppclust</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute all silhouette methods using FCM clustering</span></span>
<span><span class="va">summary_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calSilhouette.html">calSilhouette</a></span><span class="op">(</span></span>
<span>  prox_matrix <span class="op">=</span> <span class="st">"d"</span>,</span>
<span>  prob_matrix <span class="op">=</span> <span class="st">"u"</span>,</span>
<span>  proximity_type <span class="op">=</span> <span class="st">"dissimilarity"</span>,</span>
<span>  clust_fun <span class="op">=</span> <span class="fu">ppclust</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ppclust/man/fcm.html" class="external-link">fcm</a></span>,</span>
<span>  x <span class="op">=</span> <span class="va">iris</span><span class="op">[</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span>,</span>
<span>  centers <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  print.summary <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Summary of All Silhouette Methods</span></span>
<span><span class="co">#&gt; ========================================== </span></span>
<span><span class="co">#&gt;       Method     Crisp     Fuzzy    Median</span></span>
<span><span class="co">#&gt;       medoid 0.8288288 0.9297577 0.9179945</span></span>
<span><span class="co">#&gt;          pac 0.7541271 0.8799106 0.8484197</span></span>
<span><span class="co">#&gt;       pp_pac 0.7541271 0.8799106 0.8484197</span></span>
<span><span class="co">#&gt;    pp_medoid 0.8288288 0.9297577 0.9179945</span></span>
<span><span class="co">#&gt;     nlpp_pac 0.8185224 0.9304926 0.9261387</span></span>
<span><span class="co">#&gt;  nlpp_medoid 0.8749545 0.9604788 0.9616532</span></span>
<span><span class="co">#&gt;       pd_pac 0.7469894 0.8786105 0.8562152</span></span>
<span><span class="co">#&gt;    pd_medoid 0.8196600 0.9280044 0.9225377</span></span>
<span><span class="co">#&gt;          cer 0.8572481 0.9248327 0.9041529</span></span>
<span><span class="co">#&gt;           db 0.3303585 0.4206051 0.3097745</span></span>
<span></span>
<span><span class="co"># View the results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">summary_result</span><span class="op">)</span></span>
<span><span class="co">#&gt;        Method     Crisp     Fuzzy    Median</span></span>
<span><span class="co">#&gt; 1      medoid 0.8288288 0.9297577 0.9179945</span></span>
<span><span class="co">#&gt; 2         pac 0.7541271 0.8799106 0.8484197</span></span>
<span><span class="co">#&gt; 3      pp_pac 0.7541271 0.8799106 0.8484197</span></span>
<span><span class="co">#&gt; 4   pp_medoid 0.8288288 0.9297577 0.9179945</span></span>
<span><span class="co">#&gt; 5    nlpp_pac 0.8185224 0.9304926 0.9261387</span></span>
<span><span class="co">#&gt; 6 nlpp_medoid 0.8749545 0.9604788 0.9616532</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="b--method-comparison-using-output-proximity-matrices">b. Method Comparison Using Output Proximity Matrices<a class="anchor" aria-label="anchor" href="#b--method-comparison-using-output-proximity-matrices"></a>
</h4>
<p>When clustering has already been performed, you can directly use the
output matrices:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform clustering first</span></span>
<span><span class="va">fcm_result</span> <span class="op">&lt;-</span> <span class="fu">ppclust</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ppclust/man/fcm.html" class="external-link">fcm</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span>, centers <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute all silhouette methods using the clustering output</span></span>
<span><span class="va">summary_direct</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calSilhouette.html">calSilhouette</a></span><span class="op">(</span></span>
<span>  prox_matrix <span class="op">=</span> <span class="va">fcm_result</span><span class="op">$</span><span class="va">d</span>,</span>
<span>  prob_matrix <span class="op">=</span> <span class="va">fcm_result</span><span class="op">$</span><span class="va">u</span>,</span>
<span>  proximity_type <span class="op">=</span> <span class="st">"dissimilarity"</span>,</span>
<span>  a <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  print.summary <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Summary of All Silhouette Methods</span></span>
<span><span class="co">#&gt; ========================================== </span></span>
<span><span class="co">#&gt;       Method     Crisp     Fuzzy    Median</span></span>
<span><span class="co">#&gt;       medoid 0.8288288 0.9297577 0.9179945</span></span>
<span><span class="co">#&gt;          pac 0.7541271 0.8799106 0.8484197</span></span>
<span><span class="co">#&gt;       pp_pac 0.7541271 0.8799106 0.8484197</span></span>
<span><span class="co">#&gt;    pp_medoid 0.8288288 0.9297577 0.9179945</span></span>
<span><span class="co">#&gt;     nlpp_pac 0.8185224 0.9304926 0.9261387</span></span>
<span><span class="co">#&gt;  nlpp_medoid 0.8749545 0.9604788 0.9616532</span></span>
<span><span class="co">#&gt;       pd_pac 0.7469894 0.8786105 0.8562152</span></span>
<span><span class="co">#&gt;    pd_medoid 0.8196600 0.9280044 0.9225377</span></span>
<span><span class="co">#&gt;          cer 0.8572481 0.9248327 0.9041529</span></span>
<span><span class="co">#&gt;           db 0.3303585 0.4206051 0.3097745</span></span>
<span></span>
<span><span class="co"># Access specific results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">summary_direct</span><span class="op">)</span></span>
<span><span class="co">#&gt;        Method     Crisp     Fuzzy    Median</span></span>
<span><span class="co">#&gt; 1      medoid 0.8288288 0.9297577 0.9179945</span></span>
<span><span class="co">#&gt; 2         pac 0.7541271 0.8799106 0.8484197</span></span>
<span><span class="co">#&gt; 3      pp_pac 0.7541271 0.8799106 0.8484197</span></span>
<span><span class="co">#&gt; 4   pp_medoid 0.8288288 0.9297577 0.9179945</span></span>
<span><span class="co">#&gt; 5    nlpp_pac 0.8185224 0.9304926 0.9261387</span></span>
<span><span class="co">#&gt; 6 nlpp_medoid 0.8749545 0.9604788 0.9616532</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="c--comparing-clustering-algorithms-using-calsilhouette">c. Comparing Clustering Algorithms Using
<code>calSilhouette()</code><a class="anchor" aria-label="anchor" href="#c--comparing-clustering-algorithms-using-calsilhouette"></a>
</h4>
<p>A powerful application of <code><a href="../reference/calSilhouette.html">calSilhouette()</a></code> is comparing
multiple clustering algorithms across all silhouette methods:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare FCM and FCM2 algorithms</span></span>
<span><span class="va">fcm_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calSilhouette.html">calSilhouette</a></span><span class="op">(</span></span>
<span>  prox_matrix <span class="op">=</span> <span class="st">"d"</span>,</span>
<span>  prob_matrix <span class="op">=</span> <span class="st">"u"</span>,</span>
<span>  proximity_type <span class="op">=</span> <span class="st">"dissimilarity"</span>,</span>
<span>  clust_fun <span class="op">=</span> <span class="fu">ppclust</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ppclust/man/fcm.html" class="external-link">fcm</a></span>,</span>
<span>  x <span class="op">=</span> <span class="va">iris</span><span class="op">[</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span>,</span>
<span>  centers <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  print.summary <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fcm2_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calSilhouette.html">calSilhouette</a></span><span class="op">(</span></span>
<span>  prox_matrix <span class="op">=</span> <span class="st">"d"</span>,</span>
<span>  prob_matrix <span class="op">=</span> <span class="st">"u"</span>,</span>
<span>  proximity_type <span class="op">=</span> <span class="st">"dissimilarity"</span>,</span>
<span>  clust_fun <span class="op">=</span> <span class="fu">ppclust</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ppclust/man/fcm2.html" class="external-link">fcm2</a></span>,</span>
<span>  x <span class="op">=</span> <span class="va">iris</span><span class="op">[</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span>,</span>
<span>  centers <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  print.summary <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create comparison data frame</span></span>
<span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Method <span class="op">=</span> <span class="va">fcm_summary</span><span class="op">$</span><span class="va">Method</span>,</span>
<span>  FCM_Crisp <span class="op">=</span> <span class="va">fcm_summary</span><span class="op">$</span><span class="va">Crisp</span>,</span>
<span>  FCM2_Crisp <span class="op">=</span> <span class="va">fcm2_summary</span><span class="op">$</span><span class="va">Crisp</span>,</span>
<span>  FCM_Fuzzy <span class="op">=</span> <span class="va">fcm_summary</span><span class="op">$</span><span class="va">Fuzzy</span>,</span>
<span>  FCM2_Fuzzy <span class="op">=</span> <span class="va">fcm2_summary</span><span class="op">$</span><span class="va">Fuzzy</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">)</span></span>
<span><span class="co">#&gt;         Method FCM_Crisp FCM2_Crisp FCM_Fuzzy FCM2_Fuzzy</span></span>
<span><span class="co">#&gt; 1       medoid 0.8288288  0.7181559 0.9297577  0.8566239</span></span>
<span><span class="co">#&gt; 2          pac 0.7541271  0.5988649 0.8799106  0.7700619</span></span>
<span><span class="co">#&gt; 3       pp_pac 0.7541271  0.5988649 0.8799106  0.7700619</span></span>
<span><span class="co">#&gt; 4    pp_medoid 0.8288288  0.7181559 0.9297577  0.8566239</span></span>
<span><span class="co">#&gt; 5     nlpp_pac 0.8185224  0.6700537 0.9304926  0.8326067</span></span>
<span><span class="co">#&gt; 6  nlpp_medoid 0.8749545  0.7748310 0.9604788  0.8991463</span></span>
<span><span class="co">#&gt; 7       pd_pac 0.7469894  0.4262756 0.8786105  0.5744897</span></span>
<span><span class="co">#&gt; 8    pd_medoid 0.8196600  0.5598445 0.9280044  0.6963562</span></span>
<span><span class="co">#&gt; 9          cer 0.8572481  0.7452355 0.9248327  0.8427990</span></span>
<span><span class="co">#&gt; 10          db 0.3303585  0.3473950 0.4206051  0.5002794</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="d--visualizing-method-comparisons">d. Visualizing Method Comparisons<a class="anchor" aria-label="anchor" href="#d--visualizing-method-comparisons"></a>
</h4>
<p>Visualize the comparison across different methods and averaging
approaches:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Reshape data for plotting</span></span>
<span><span class="va">comparison_long</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>  <span class="va">comparison</span>,</span>
<span>  cols <span class="op">=</span> <span class="op">-</span><span class="va">Method</span>,</span>
<span>  names_to <span class="op">=</span> <span class="st">"Algorithm_Type"</span>,</span>
<span>  values_to <span class="op">=</span> <span class="st">"Silhouette_Width"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create grouped bar plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">comparison_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Method</span>, y <span class="op">=</span> <span class="va">Silhouette_Width</span>, fill <span class="op">=</span> <span class="va">Algorithm_Type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Comparison of Silhouette Methods: FCM vs FCM2"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Silhouette Method"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Average Silhouette Width"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"Algorithm &amp; Type"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"gray40"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Silhouette_files/figure-html/calSil4-1.png" alt="fig7.1" width="768"></p>
</div>
<div class="section level4">
<h4 id="e--selecting-optimal-number-of-clusters-using-calsilhouette">e. Selecting Optimal Number of Clusters Using
<code>calSilhouette()</code><a class="anchor" aria-label="anchor" href="#e--selecting-optimal-number-of-clusters-using-calsilhouette"></a>
</h4>
<p>Use <code><a href="../reference/calSilhouette.html">calSilhouette()</a></code> to evaluate clustering quality
across different numbers of clusters:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute silhouette summaries for k = 2 to 6</span></span>
<span><span class="va">k_range</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">:</span><span class="fl">6</span></span>
<span><span class="va">results_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="va">k_range</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">results_list</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calSilhouette.html">calSilhouette</a></span><span class="op">(</span></span>
<span>    prox_matrix <span class="op">=</span> <span class="st">"d"</span>,</span>
<span>    prob_matrix <span class="op">=</span> <span class="st">"u"</span>,</span>
<span>    proximity_type <span class="op">=</span> <span class="st">"dissimilarity"</span>,</span>
<span>    clust_fun <span class="op">=</span> <span class="fu">ppclust</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ppclust/man/fcm.html" class="external-link">fcm</a></span>,</span>
<span>    x <span class="op">=</span> <span class="va">iris</span><span class="op">[</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span>,</span>
<span>    centers <span class="op">=</span> <span class="va">k</span>,</span>
<span>    print.summary <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Extract crisp pac method silhouette widths for comparison</span></span>
<span><span class="va">pac_widths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">results_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">Crisp</span><span class="op">[</span><span class="va">x</span><span class="op">$</span><span class="va">Method</span> <span class="op">==</span> <span class="st">"pac"</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot optimal k selection</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">k_range</span>, <span class="va">pac_widths</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"o"</span>, pch <span class="op">=</span> <span class="fl">19</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Number of Clusters (k)"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Average Silhouette Width (PAC method)"</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Optimal Cluster Selection using calSilhouette()"</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"steelblue"</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">pac_widths</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.95</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">pac_widths</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.05</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">pac_widths</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">k_range</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">pac_widths</span><span class="op">)</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">pac_widths</span><span class="op">)</span>, </span>
<span>     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Optimal k ="</span>, <span class="va">k_range</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">pac_widths</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, </span>
<span>     pos <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Silhouette_files/figure-html/calSil5-1.png" alt="fig7.2" width="768"></p>
</div>
<div class="section level4">
<h4 id="f--method-specific-analysis">f. Method-Specific Analysis<a class="anchor" aria-label="anchor" href="#f--method-specific-analysis"></a>
</h4>
<p>Extract and analyze specific methods from the comprehensive
summary:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get all pac-based methods</span></span>
<span><span class="va">pac_methods</span> <span class="op">&lt;-</span> <span class="va">summary_result</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"pac"</span>, <span class="va">summary_result</span><span class="op">$</span><span class="va">Method</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"PAC-based methods:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; PAC-based methods:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pac_methods</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Method     Crisp     Fuzzy    Median</span></span>
<span><span class="co">#&gt;       pac 0.7541271 0.8799106 0.8484197</span></span>
<span><span class="co">#&gt;    pp_pac 0.7541271 0.8799106 0.8484197</span></span>
<span><span class="co">#&gt;  nlpp_pac 0.8185224 0.9304926 0.9261387</span></span>
<span><span class="co">#&gt;    pd_pac 0.7469894 0.8786105 0.8562152</span></span>
<span></span>
<span><span class="co"># Get all medoid-based methods</span></span>
<span><span class="va">medoid_methods</span> <span class="op">&lt;-</span> <span class="va">summary_result</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"medoid"</span>, <span class="va">summary_result</span><span class="op">$</span><span class="va">Method</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nMedoid-based methods:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Medoid-based methods:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">medoid_methods</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Method     Crisp     Fuzzy    Median</span></span>
<span><span class="co">#&gt;       medoid 0.8288288 0.9297577 0.9179945</span></span>
<span><span class="co">#&gt;    pp_medoid 0.8288288 0.9297577 0.9179945</span></span>
<span><span class="co">#&gt;  nlpp_medoid 0.8749545 0.9604788 0.9616532</span></span>
<span><span class="co">#&gt;    pd_medoid 0.8196600 0.9280044 0.9225377</span></span>
<span></span>
<span><span class="co"># Get probability-based methods (cer, db)</span></span>
<span><span class="va">prob_methods</span> <span class="op">&lt;-</span> <span class="va">summary_result</span><span class="op">[</span><span class="va">summary_result</span><span class="op">$</span><span class="va">Method</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cer"</span>, <span class="st">"db"</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nProbability-based methods (cer, db):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Probability-based methods (cer, db):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">prob_methods</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Method     Crisp     Fuzzy    Median</span></span>
<span><span class="co">#&gt;     cer 0.8572481 0.9248327 0.9041529</span></span>
<span><span class="co">#&gt;      db 0.3303585 0.4206051 0.3097745</span></span>
<span></span>
<span><span class="co"># Compare crisp vs fuzzy vs median averaging</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n=== Best Methods by Averaging Type ===\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Best Methods by Averaging Type ===</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Best method by crisp averaging:"</span>, </span>
<span>    <span class="va">summary_result</span><span class="op">$</span><span class="va">Method</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">summary_result</span><span class="op">$</span><span class="va">Crisp</span><span class="op">)</span><span class="op">]</span>, </span>
<span>    <span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">summary_result</span><span class="op">$</span><span class="va">Crisp</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">")\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Best method by crisp averaging: nlpp_medoid ( 0.875 )</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Best method by fuzzy averaging:"</span>, </span>
<span>    <span class="va">summary_result</span><span class="op">$</span><span class="va">Method</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">summary_result</span><span class="op">$</span><span class="va">Fuzzy</span><span class="op">)</span><span class="op">]</span>, </span>
<span>    <span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">summary_result</span><span class="op">$</span><span class="va">Fuzzy</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">")\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Best method by fuzzy averaging: nlpp_medoid ( 0.9605 )</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Best method by median averaging:"</span>, </span>
<span>    <span class="va">summary_result</span><span class="op">$</span><span class="va">Method</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">summary_result</span><span class="op">$</span><span class="va">Median</span><span class="op">)</span><span class="op">]</span>, </span>
<span>    <span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">summary_result</span><span class="op">$</span><span class="va">Median</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">")\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Best method by median averaging: nlpp_medoid ( 0.9617 )</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="g--comparing-only-proximity-based-methods">g. Comparing Only Proximity-Based Methods<a class="anchor" aria-label="anchor" href="#g--comparing-only-proximity-based-methods"></a>
</h4>
<p>When only the proximity matrix is available (e.g., for crisp
clustering), <code><a href="../reference/calSilhouette.html">calSilhouette()</a></code> automatically computes only
the applicable methods:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">proxy</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># K-means clustering (crisp clustering)</span></span>
<span><span class="va">km</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span>, centers <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute distance matrix</span></span>
<span><span class="va">dist_matrix</span> <span class="op">&lt;-</span> <span class="fu">proxy</span><span class="fu">::</span><span class="fu">dist</span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span>, <span class="va">km</span><span class="op">$</span><span class="va">centers</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute only proximity-based silhouettes (medoid and pac)</span></span>
<span><span class="va">crisp_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calSilhouette.html">calSilhouette</a></span><span class="op">(</span></span>
<span>  prox_matrix <span class="op">=</span> <span class="va">dist_matrix</span>,</span>
<span>  proximity_type <span class="op">=</span> <span class="st">"dissimilarity"</span>,</span>
<span>  print.summary <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Summary of All Silhouette Methods</span></span>
<span><span class="co">#&gt; ========================================== </span></span>
<span><span class="co">#&gt;  Method     Crisp    Median</span></span>
<span><span class="co">#&gt;  medoid 0.6663856 0.7254804</span></span>
<span><span class="co">#&gt;     pac 0.5375927 0.5692253</span></span>
<span></span>
<span><span class="co"># View results (note: no Fuzzy column since prob_matrix not provided)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">crisp_summary</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Method     Crisp    Median</span></span>
<span><span class="co">#&gt; 1 medoid 0.6663856 0.7254804</span></span>
<span><span class="co">#&gt; 2    pac 0.5375927 0.5692253</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="h--heatmap-visualization-of-method-comparisons">h. Heatmap Visualization of Method Comparisons<a class="anchor" aria-label="anchor" href="#h--heatmap-visualization-of-method-comparisons"></a>
</h4>
<p>Create a heatmap to visualize performance across methods and
averaging types:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Reshape data for heatmap</span></span>
<span><span class="va">heatmap_data</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>  <span class="va">summary_result</span>,</span>
<span>  cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Crisp</span>, <span class="va">Fuzzy</span>, <span class="va">Median</span><span class="op">)</span>,</span>
<span>  names_to <span class="op">=</span> <span class="st">"Average_Type"</span>,</span>
<span>  values_to <span class="op">=</span> <span class="st">"Silhouette_Width"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create heatmap</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">heatmap_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Average_Type</span>, y <span class="op">=</span> <span class="va">Method</span>, fill <span class="op">=</span> <span class="va">Silhouette_Width</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">Silhouette_Width</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient2</a></span><span class="op">(</span></span>
<span>    low <span class="op">=</span> <span class="st">"red"</span>, mid <span class="op">=</span> <span class="st">"yellow"</span>, high <span class="op">=</span> <span class="st">"green"</span>,</span>
<span>    midpoint <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">heatmap_data</span><span class="op">$</span><span class="va">Silhouette_Width</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    na.value <span class="op">=</span> <span class="st">"gray90"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">0</span>, hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"right"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Silhouette Width Heatmap Across Methods and Averaging Types"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Averaging Type"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Silhouette Method"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"Silhouette\nWidth"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="Silhouette_files/figure-html/calSil8-1.png" alt="fig7.3" width="768"></p>
<p><strong>Practical Guidance:</strong></p>
<ul>
<li>Use <code><a href="../reference/calSilhouette.html">calSilhouette()</a></code> when you need a comprehensive
overview of clustering quality across multiple methodological
perspectives</li>
<li>The function is especially useful for algorithm comparison studies
and sensitivity analyses</li>
<li>Different methods may highlight different aspects of cluster
quality; examining multiple methods provides a more robust
assessment</li>
<li>For crisp clustering (when only proximity matrix is available), the
function automatically computes only the applicable methods (medoid,
pac)</li>
<li>The <code>a</code> parameter controls the fuzzifier for weighted
averaging in fuzzy methods (default = 2)</li>
<li>Consider using heatmaps or grouped bar plots to visualize method
comparisons effectively</li>
<li>When selecting optimal number of clusters, examine multiple methods
rather than relying on a single metric</li>
</ul>
<p><strong>Interpretation Guidelines:</strong></p>
<ul>
<li>
<strong>Crisp averaging</strong>: Unweighted average, treats all
observations equally</li>
<li>
<strong>Fuzzy averaging</strong>: Weighted by membership
probabilities, emphasizes observations with stronger cluster
membership</li>
<li>
<strong>Median averaging</strong>: Robust to outliers, provides
stable estimates in the presence of extreme values</li>
<li>
<strong>PAC methods</strong>: More penalized, conservative estimates
of cluster quality</li>
<li>
<strong>Medoid methods</strong>: Less penalized, may be more
optimistic about cluster separation</li>
<li>
<strong>Density-based (db)</strong>: Considers log-ratios of
posterior probabilities, good for identifying density-based cluster
structure</li>
<li>
<strong>Certainty-based (cer)</strong>: Uses maximum posterior
probabilities, emphasizes confidence in cluster assignments</li>
</ul>
<p><strong>Summary:</strong></p>
<p><code><a href="../reference/calSilhouette.html">calSilhouette()</a></code> provides a powerful, unified interface
for comprehensive silhouette analysis, enabling researchers to evaluate
clustering solutions from multiple perspectives simultaneously. This
function streamlines comparative studies, supports robust cluster
validation, and facilitates reproducible clustering diagnostics across
different algorithms and parameter settings. Its integration with the
package’s visualization capabilities makes it an essential tool for
thorough clustering quality assessment in both crisp and soft clustering
contexts.## 7. Extended Silhouette Analysis for Multi-Way Clustering</p>
<p>The <code><a href="../reference/extSilhouette.html">extSilhouette()</a></code> function enables silhouette-based
evaluation for multi-way clustering scenarios, such as biclustering or
tensor clustering, by aggregating silhouette indices from each mode
(e.g., rows, columns) into a single summary metric. This approach allows
you to rigorously assess the overall clustering structure when
partitioning data along multiple dimensions.</p>
<p><strong>Workflow:</strong></p>
<ul>
<li>
<strong>Step 1: Apply Multi-Way Clustering</strong><br>
Fit a biclustering algorithm to your data—in this example, we use
<code><a href="https://rdrr.io/pkg/blockcluster/man/coclusterContinuous.html" class="external-link">blockcluster::coclusterContinuous()</a></code> to jointly cluster the
rows and columns of the <code>iris</code> dataset.</li>
</ul>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gitlab.inria.fr/iovleff/blockcluster" class="external-link">blockcluster</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/blockcluster/man/coclusterContinuous.html" class="external-link">coclusterContinuous</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/proxy/man/dist.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span>, nbcocluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Co-Clustering successfully terminated!</span></span></code></pre></div>
<ul>
<li>
<strong>Step 2: Compute Silhouette Widths for Each
Mode</strong><br>
For each dimension (e.g., rows and columns), calculate silhouette widths
using the membership probability matrices
(<code>result@rowposteriorprob</code> for rows,
<code>result@colposteriorprob</code> for columns) via the
<code><a href="../reference/softSilhouette.html">softSilhouette()</a></code> function: (One can use any
<code>Silhouette</code> class function to calculate when relevant
proximity measure available, For consistency make sure all objects in
list derived from same <code>method</code> and arguments.)</li>
</ul>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sil_mode1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/softSilhouette.html">softSilhouette</a></span><span class="op">(</span></span>
<span>  prob_matrix <span class="op">=</span> <span class="va">result</span><span class="op">@</span><span class="va">rowposteriorprob</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"pac"</span>,</span>
<span>  print.summary <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">sil_mode2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/softSilhouette.html">softSilhouette</a></span><span class="op">(</span></span>
<span>  prob_matrix <span class="op">=</span> <span class="va">result</span><span class="op">@</span><span class="va">colposteriorprob</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"pac"</span>,</span>
<span>  print.summary <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<strong>Step 3: Aggregate Silhouette Results with
<code><a href="../reference/extSilhouette.html">extSilhouette()</a></code></strong><br>
Combine the silhouette analyses from each mode by passing them as a list
to <code><a href="../reference/extSilhouette.html">extSilhouette()</a></code>. Optionally, provide descriptive
dimension names:</li>
</ul>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ext_sil</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extSilhouette.html">extSilhouette</a></span><span class="op">(</span></span>
<span>  sil_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">sil_mode1</span>, <span class="va">sil_mode2</span><span class="op">)</span>,</span>
<span>  dim_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rows"</span>, <span class="st">"Columns"</span><span class="op">)</span>,</span>
<span>  print.summary <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; ---------------------------</span></span>
<span><span class="co">#&gt; Extended silhouette: 0.7057 </span></span>
<span><span class="co">#&gt; ---------------------------</span></span>
<span><span class="co">#&gt; Dimension Summary:</span></span>
<span><span class="co">#&gt;   dimension n_obs avg_sil_width</span></span>
<span><span class="co">#&gt; 1      Rows   150        0.6979</span></span>
<span><span class="co">#&gt; 2   Columns     4        1.0000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Available components:</span></span>
<span><span class="co">#&gt; [1] "ext_sil_width" "dim_table"</span></span></code></pre></div>
<p><strong>Summary:</strong><br>
The <code><a href="../reference/extSilhouette.html">extSilhouette()</a></code> function returns: - The overall
extended silhouette width—a weighted average summarizing clustering
quality across all modes. - A dimension statistics table, reporting the
number of observations and average silhouette width for each mode (e.g.,
rows, columns).</p>
<p><em>Note:</em>  If a distance matrix is available from the output of
a biclustering algorithm, you can compute individual mode silhouettes
using <code><a href="../reference/Silhouette.html">Silhouette()</a></code>.</p>
<p>The results can be combined with <code><a href="../reference/extSilhouette.html">extSilhouette()</a></code> to
enable direct comparison of clustering solutions across multiple
biclustering algorithms, facilitating objective model assessment <span class="citation">(Kapu and C 2025)</span>.</p>
<p>This methodology provides a concise and interpretable assessment for
complex clustering models where conventional one-dimensional indices are
insufficient.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-bhatkapu2024density" class="csl-entry">
Bhat Kapu, S., and Kiruthika. 2024. <span>“Some Density-Based Silhouette
Diagnostics for Soft Clustering Algorithms.”</span> <em>Communications
in Statistics: Case Studies, Data Analysis and Applications</em> 10
(3-4): 221–38. <a href="https://doi.org/10.1080/23737484.2024.2408534" class="external-link">https://doi.org/10.1080/23737484.2024.2408534</a>.
</div>
<div id="ref-campello2006fuzzy" class="csl-entry">
Campello, R. J., and E. R. Hruschka. 2006. <span>“A Fuzzy Extension of
the Silhouette Width Criterion for Cluster Analysis.”</span> <em>Fuzzy
Sets and Systems</em> 157 (21): 2858–75. <a href="https://doi.org/10.1016/j.fss.2006.07.006" class="external-link">https://doi.org/10.1016/j.fss.2006.07.006</a>.
</div>
<div id="ref-bhat2025block" class="csl-entry">
Kapu, Shrikrishna Bhat, and Kiruthika C. 2025. <span>“Block
Probabilistic Distance Clustering: A Unified Framework and
Evaluation.”</span> <a href="https://doi.org/10.21203/rs.3.rs-6973596/v1" class="external-link">https://doi.org/10.21203/rs.3.rs-6973596/v1</a>.
</div>
<div id="ref-menardi2011density" class="csl-entry">
Menardi, Giovanna. 2011. <span>“Density-Based Silhouette Diagnostics for
Clustering Methods.”</span> <em>Statistics and Computing</em> 21 (3):
295–308. <a href="https://doi.org/10.1007/s11222-010-9169-0" class="external-link">https://doi.org/10.1007/s11222-010-9169-0</a>.
</div>
<div id="ref-raymaekers2022silhouettes" class="csl-entry">
Raymaekers, J., and P. J. Rousseeuw. 2022. <span>“Silhouettes and Quasi
Residual Plots for Neural Nets and Tree-Based Classifiers.”</span>
<em>Journal of Computational and Graphical Statistics</em> 31 (4):
1332–43. <a href="https://doi.org/10.1080/10618600.2022.2050249" class="external-link">https://doi.org/10.1080/10618600.2022.2050249</a>.
</div>
<div id="ref-rousseeuw1987silhouettes" class="csl-entry">
Rousseeuw, P. J. 1987. <span>“Silhouettes: A Graphical Aid to the
Interpretation and Validation of Cluster Analysis.”</span> <em>Journal
of Computational and Applied Mathematics</em> 20: 53–65. <a href="https://doi.org/10.1016/0377-0427(87)90125-7" class="external-link">https://doi.org/10.1016/0377-0427(87)90125-7</a>.
</div>
<div id="ref-schepers2008multimode" class="csl-entry">
Schepers, J., E. Ceulemans, and I. Van Mechelen. 2008. <span>“Selecting
Among Multi-Mode Partitioning Models of Different Complexities: A
Comparison of Four Model Selection Criteria.”</span> <em>Journal of
Classification</em> 25 (1): 67–85. <a href="https://doi.org/10.1007/s00357-008-9005-9" class="external-link">https://doi.org/10.1007/s00357-008-9005-9</a>.
</div>
<div id="ref-vanderlaan2003pam" class="csl-entry">
Van der Laan, M., K. Pollard, and J. Bryan. 2003. <span>“A New
Partitioning Around Medoids Algorithm.”</span> <em>Journal of
Statistical Computation and Simulation</em> 73 (8): 575–84. <a href="https://doi.org/10.1080/0094965031000136012" class="external-link">https://doi.org/10.1080/0094965031000136012</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/kskbhat" class="external-link">Shrikrishna Bhat K</a>, <a href="https://www.pondiuni.edu.in/faculy_profiles/dr-kiruthika/" class="external-link">Kiruthika C</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
